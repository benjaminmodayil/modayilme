@function color($key) {
  @return map-get($colors, '#{ $key }');
}

$colors: (
  'black': lighten(#292929, 10%),
  'text': #292929,
  'link': darken(#ff545a, 20%),
  'red': darken(#ff545a, 20%),
  'grey': #e9e9e9,
  'white': #fff,
  'text-main': #fff,
  'bg': #3e363f,
  'bg-secondary': #f2f2f2,
  'bg-grey': #393d3f
);

$bg-light: lighten(color(bg), 5%);

:root {
  --bg-light: $bg-light;
  --header: color(bg);
  --link-hover: color(link);
}

@mixin variable($property, $variable, $fallback) {
  #{$property}: $fallback;
  #{$property}: var($variable);
}

// runs like: @include variable(background, --theme-primary-color, color(blue));

:root {
  @each $color, $variableColor in $colors {
    --#{$color}: #{$variableColor};
  }
}

@each $color, $textColor in $colors {
  .color--#{$color} {
    color: #{$textColor};
    color: var(--#{$color});
  }

  .bg-color--#{$color} {
    background-color: #{$textColor};
    background-color: var(--#{$color});
  }
}
